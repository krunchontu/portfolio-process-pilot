# <!-- Powered by BMADT Core -->

# Story 4.3: Frontend API Client Cleanup (Small)

## Status
Draft

## Story
**As a** frontend engineer,
**I want** a clean, consistent API client without duplication and with unified error handling,
**So that** the codebase is easier to maintain and user-facing errors behave consistently.

## Acceptance Criteria
1. Remove duplicate method aliases (e.g., `get` and `getById`) while keeping a single, clear method per use-case.
2. Establish a consistent error handling policy (toasts/logging) for 4xx/5xx/timeouts and apply it across API calls; ensure no duplicate toasts are emitted for a single failure.
3. Preserve auth/CSRF behavior (cookie-based auth, CSRF token header pass-through) with no regressions.
4. Update/expand unit tests for the API client; existing tests pass.
5. No breaking changes to public API paths; consuming components continue to function.

## Tasks / Subtasks
- [ ] Audit existing API client (`frontend/src/services/api.js`) (AC: 1)
  - [ ] Identify and remove duplicated functions (`get` vs `getById`, etc.)
  - [ ] Ensure exported API surface remains stable for consumers
- [ ] Unify error handling policy (AC: 2)
  - [ ] Define toast + console/log usage for network/timeout/4xx/5xx/429
  - [ ] Apply policy in interceptors and method wrappers
- [ ] Preserve security flows (AC: 3)
  - [ ] Verify CSRF header echo and refresh flows still work
  - [ ] Confirm `withCredentials` remains enabled
- [ ] Tests & verification (AC: 4-5)
  - [ ] Update tests (`frontend/tests/services/api.test.js`) and add new cases if needed
  - [ ] Run E2E smoke for auth/requests to ensure no regression
  - [ ] Spot-check consuming views: `RequestsPage`, `RequestDetailPage`, `DashboardPage` for unchanged behavior
- [ ] Documentation (AC: 2)
  - [ ] Brief notes in `frontend/tests/e2e/README.md` or a small section in README about error behavior

## Dev Notes

### Relevant Code
- `frontend/src/services/api.js` (axios instance, interceptors, helpers)
- Tests: `frontend/tests/services/api.test.js`, E2E specs under `frontend/tests/e2e/*`

### Architecture & Standards References
- [Source: docs/architecture/coding-standards.md]
- [Source: docs/architecture/tech-stack.md]

### Technical Considerations
- Maintain cookie-based auth and CSRF flow; avoid token storage in localStorage.
- Keep error UX consistent: avoid duplicate toasts; centralize where possible.

## Change Log
| Date       | Version | Description                           | Author            |
|------------|---------|---------------------------------------|-------------------|
| 2025-09-14 | 1.0     | Initial draft of Story 4.3            | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
N/A (Story draft)

### Debug Log References
- Planned: API client unit tests and E2E auth/request flows
